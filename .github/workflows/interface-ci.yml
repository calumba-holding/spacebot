name: Interface CI

on:
  push:
    branches: [main]
    paths:
      - "interface/**"
  pull_request:
    branches: [main]
    paths:
      - "interface/**"

jobs:
  quality:
    name: Interface Quality
    runs-on: ubuntu-24.04
    defaults:
      run:
        working-directory: interface
    steps:
      - uses: actions/checkout@v4

      - uses: oven-sh/setup-bun@v1

      - name: Install dependencies
        run: bun install --os=linux --cpu=x64

      - name: Install native toolchain packages
        run: |
          esbuild_version="$(node -p "require('./node_modules/esbuild/package.json').version")"
          bun add --dev --no-save --no-progress "@esbuild/linux-x64@${esbuild_version}"
          rollup_version="$(node -p "require('./node_modules/rollup/package.json').version")"
          bun add --dev --no-save --no-progress "@rollup/rollup-linux-x64-gnu@${rollup_version}"

      - name: Typecheck
        run: bunx tsc --noEmit

      - name: Build
        run: bun run build
